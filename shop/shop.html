<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mafia - Dashboard</title>
    <link rel="stylesheet" href="shop.css" type="text/CSS">

    <!-- Font -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

</head>
<body>
    
    <!-- Header -->
    <header>
        <!-- nav -->
        <div class="nav container">
            <a href="" class="logo">Mafia</a>

            <ul>
                <li class="navlist">
                    <a href="#" class="link">home</a>
                    <a href="#" class="link">home</a>
                    <a href="#" class="link">home</a>
                    <a href="#" class="link">home</a>
                </li>
            </ul>

            <!-- Cart icon -->
            <i class="bx bx-shopping-bag" id="cart-icon"></i>

            <!-- Cart container -->
            <div class="cart">
                <h2 class="cart-title">Your Cart</h2>

                <div class="cart-content">

                </div>

                <!-- Total -->
                 <div class="total">
                    <div class="total-title">Total</div>
                    <div class="total-price">$0</div>
                 </div>

                 <!-- Buy Btn -->
                 <button type="button" class="btn-buy">Buy Now</button>

                 <!-- Cart Close -->
                  <i class="bx bx-x cross" id="close-cart"></i>
            </div>
        </div>
        
    </header>
    
    <section class="shop container">

        <!-- Title -->


        <h2 class="section-title">GTA 5 - CAR COLLECTION</h2>

        <div class="search">
            <i class="bx bx-search" id="cart-icon"></i>
            <input type="text" name="" id="search-item" placeholder="Search Model" onkeyup="search()">
        </div>
            

        <!-- Content -->
         <div class="shop-content" id="shop-content">
            <!-- Product Box: 1 -->
             <div class="product-box">
                <img src="./img/1.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXeT 2</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$2500.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 2 -->
             <div class="product-box">
                <img src="./img/2.jpg" alt="" class="product-img">
                <h2 class="product-title">Tblabla</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 3 -->
             <div class="product-box">
                <img src="./img/3.jpg" alt="" class="product-img">
                <h2 class="product-title">haha 1haha 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 4 -->
             <div class="product-box">
                <img src="./img/4.jpg" alt="" class="product-img">
                <h2 class="product-title">haha 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 5 -->
             <div class="product-box">
                <img src="./img/5.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXT 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 6 -->
             <div class="product-box">
                <img src="./img/6.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXT 1</h2>
                <h3 class="product-desc">newme</h3>
                <h3 class="product-desc">thistoo</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 7 -->
             <div class="product-box">
                <img src="./img/7.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXT 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 8 -->
             <div class="product-box">
                <img src="./img/8.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXT 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 9 -->
             <div class="product-box">
                <img src="./img/9.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXT 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 10 -->
             <div class="product-box">
                <img src="./img/10.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXT 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 11 -->
             <div class="product-box">
                <img src="./img/11.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXT 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 12 -->
             <div class="product-box">
                <img src="./img/12.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXT 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 13 -->
             <div class="product-box">
                <img src="./img/13.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXT 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 14 -->

             <div class="product-box">
                <img src="./img/14.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXT 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

             <!-- Product Box: 15 -->
             <div class="product-box">
                <img src="./img/15.jpg" alt="" class="product-img">
                <h2 class="product-title">TEXT 1</h2>
                <h3 class="product-desc">manufucturer: name</h3>
                <h3 class="product-desc">Type: name</h3>
                <span class="price">$25000.00</span>
                <i class="bx bx-shopping-bag add-cart"></i>
             </div>

         </div>
    </section>
    <script>
        let cartIcon = document.querySelector("#cart-icon");
        let cart = document.querySelector(".cart");
        let closeCart = document.querySelector("#close-cart");

        // Open Cart
        cartIcon.onclick = () =>{
            cart.classList.add("active");
        }

        // Close Cart
        closeCart.onclick = () =>{
            cart.classList.remove("active");
        }

        // Cart Working

        if (document.readyState == 'loading'){
            document.addEventListener("DOMContentLoaded", ready);
        }   
        else{
            ready();
        }

        // Function -----------------

        // 
        function ready() {
            var removeCartButtons = document.getElementsByClassName('cart-remove');
            console.log(removeCartButtons)
            for( var i = 0; i < removeCartButtons.length; i++){
                var button = removeCartButtons[i]
                button.addEventListener("click", removeCartItem)
            }

            // Quantity Changes
            var quantityInputs = document.getElementsByClassName('cart-quantity');
            for( var i = 0; i < quantityInputs.length; i++){
                var input = quantityInputs[i]
                input.addEventListener('change', quantityChanged);
            }
            var addCart = document.getElementsByClassName('add-cart');
            for( var i = 0; i < addCart.length; i++){
                var button = addCart[i];
                button.addEventListener("click", addCartClicked);
            }
            // Buy Btn work
            document.getElementsByClassName("btn-buy")[0].addEventListener("click", buyButtonClicked);
        }

        // Buy Button

        function buyButtonClicked(){
            alert("Your Order is Placed")
            var cartContent = document.getElementsByClassName("cart-content")[0]
            while(cartContent.hasChildNodes()){
                cartContent.removeChild(cartContent.firstChild);
            }
            updatetotal();
        }

        // remove Item from Cart
        function removeCartItem(event){
            var buttonClicked = event.target;
            buttonClicked.parentElement.remove();
            updatetotal();
        }

        function quantityChanged(event){
            var input = event.target;
            if (isNaN(input.value) || input.value <= 0){
                input.value = 1;
            }
            updatetotal();
        }


        function addCartClicked(event){
            var button = event.target;
            var shopProducts = button.parentElement;
            var title = shopProducts.getElementsByClassName("product-title")[0].innerText;
            var price = shopProducts.getElementsByClassName("price")[0].innerText;
            var productImg = shopProducts.getElementsByClassName("product-img")[0].src;
            addProductToCart(title, price, productImg);
            updatetotal();
        }

        // Add product to Cart
        function addProductToCart(title, price, productImg){
            var cartShopBox = document.createElement("div");
            cartShopBox.classList.add('cart-box');
            var cartItems = document.getElementsByClassName("cart-content")[0];
            var cartItemsNames = cartItems.getElementsByClassName("cart-product-title");
            for(var i = 0; i < cartItemsNames.length; i++) {
                if (cartItemsNames[i].innerText == title){

                
                    alert("You have already add this item to your cart");
                    return;
                }
            } 
        

            var cartBoxContent = `
                                    <img src="${productImg}" alt="" class="cart-img">
                                    <div class="detail-box">
                                        <div class="cart-product-title">${title}</div>
                                        <div class="cart-price">${price}</div>
                                        <input type="number" value="1" class="cart-quantity">
                                    </div>
                                
                                    <!-- Remove Cart -->
                                    <i class="bx bxs-trash-alt cart-remove"></i>`;

            cartShopBox.innerHTML = cartBoxContent;
            cartItems.append(cartShopBox);
            cartShopBox
                .getElementsByClassName('cart-remove')[0]
                .addEventListener('click', removeCartItem);

            cartShopBox
                .getElementsByClassName('cart-quantity')[0]
                .addEventListener('change', quantityChanged);
        }
        // Update Total
        function updatetotal() {
            var cartContent = document.getElementsByClassName('cart-content')[0];
            var cartBoxes = cartContent.getElementsByClassName('cart-box');
            var total = 0;
            for( var i = 0; i < cartBoxes.length; i++){
                var cartBox = cartBoxes[i];
                var priceElement = cartBox.getElementsByClassName('cart-price')[0];
                var quantityElement = cartBox.getElementsByClassName('cart-quantity')[0];
                var price = parseFloat(priceElement.innerText.replace("$", ""));
                var quantity = quantityElement.value;
                total = total + (price * quantity);
            }
                // for cent values

                total = Math.round(total * 100) / 100;

                document.getElementsByClassName("total-price")[0].innerText = "$" + total;
        }

        // Search Function

        const search = () =>{
            // fetching user input 
            const searchbox = document.getElementById("search-item").value.toUpperCase();
            const storeitems = document.getElementById("shop-content")
            const product = document.querySelectorAll(".product-box")
            
            const pname = document.getElementsByTagName("h2") // Product name
            const dname = document.getElementsByTagName("h3") // Product Desc

            for (var i = 0; i < pname.length; i++){
                let matchp = product[i].getElementsByTagName('h2')[0];
                let matchd = product[i].getElementsByTagName('h3')[0];

                if(matchp || matchd){
                    let textvalue = matchp.textContent || matchp.innerHTML 
                    let descvalue = matchd.textContent || matchd.innerHTML

                    if(textvalue.toUpperCase().indexOf(searchbox) > -1){
                        product[i].style.display = "";
                    }

                    else if(descvalue.toUpperCase().indexOf(searchbox) > -1){
                        product[i].style.display = "";
                    }
                    else{
                        product[i].style.display = "none";
                    }
                }
            }
        }

    </script>
</body>
</html>